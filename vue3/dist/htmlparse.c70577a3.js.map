{"version":3,"sources":["htmlparse.js"],"names":["startTag","endTag","attr","empty","makeMap","block","inline","closeSelf","fillAttrs","special","HTMLParser","html","handler","index","chars","match","stack","last","length","indexOf","comment","substring","replace","parseEndTag","parseStartTag","text","RegExp","all","tag","tagName","rest","unary","toLowerCase","push","start","attrs","name","value","arguments","escaped","pos","i","end","HTMLtoXML","results","HTMLtoDOM","doc","one","structure","link","base","DOMDocument","document","implementation","createDocument","ActiveX","ActiveXObject","ownerDocument","getOwnerDocument","elems","documentElement","getDocumentElement","createElement","head","appendChild","getElementsByTagName","curParentNode","body","elem","setAttribute","createTextNode","str","obj","items","split"],"mappings":"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","file":"htmlparse.c70577a3.js","sourceRoot":"../src","sourcesContent":["/*\n * HTML Parser By John Resig (ejohn.org)\n * Original code by Erik Arvidsson, Mozilla Public License\n * http://erik.eae.net/simplehtmlparser/simplehtmlparser.js\n *\n * // Use like so:\n * HTMLParser(htmlString, {\n *     start: function(tag, attrs, unary) {},\n *     end: function(tag) {},\n *     chars: function(text) {},\n *     comment: function(text) {}\n * });\n *\n * // or to get an XML string:\n * HTMLtoXML(htmlString);\n *\n * // or to get an XML DOM Document\n * HTMLtoDOM(htmlString);\n *\n * // or to inject into an existing document/DOM node\n * HTMLtoDOM(htmlString, document);\n * HTMLtoDOM(htmlString, document.body);\n *\n */\n\n(function(){\n\n\t// Regular Expressions for parsing tags and attributes\n\tvar startTag = /^<([-A-Za-z0-9_]+)((?:\\s+\\w+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)>/,\n\t\tendTag = /^<\\/([-A-Za-z0-9_]+)[^>]*>/,\n\t\tattr = /([-A-Za-z0-9_]+)(?:\\s*=\\s*(?:(?:\"((?:\\\\.|[^\"])*)\")|(?:'((?:\\\\.|[^'])*)')|([^>\\s]+)))?/g;\n\t\t\n\t// Empty Elements - HTML 4.01\n\tvar empty = makeMap(\"area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed\");\n\n\t// Block Elements - HTML 4.01\n\tvar block = makeMap(\"address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul\");\n\n\t// Inline Elements - HTML 4.01\n\tvar inline = makeMap(\"a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var\");\n\n\t// Elements that you can, intentionally, leave open\n\t// (and which close themselves)\n\tvar closeSelf = makeMap(\"colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr\");\n\n\t// Attributes that have their values filled in disabled=\"disabled\"\n\tvar fillAttrs = makeMap(\"checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected\");\n\n\t// Special Elements (can contain anything)\n\tvar special = makeMap(\"script,style\");\n\n\tvar HTMLParser = this.HTMLParser = function( html, handler ) {\n\t\tvar index, chars, match, stack = [], last = html;\n\t\tstack.last = function(){\n\t\t\treturn this[ this.length - 1 ];\n\t\t};\n\n\t\twhile ( html ) {\n\t\t\tchars = true;\n\n\t\t\t// Make sure we're not in a script or style element\n\t\t\tif ( !stack.last() || !special[ stack.last() ] ) {\n\n\t\t\t\t// Comment\n\t\t\t\tif ( html.indexOf(\"<!--\") == 0 ) {\n\t\t\t\t\tindex = html.indexOf(\"-->\");\n\t\n\t\t\t\t\tif ( index >= 0 ) {\n\t\t\t\t\t\tif ( handler.comment )\n\t\t\t\t\t\t\thandler.comment( html.substring( 4, index ) );\n\t\t\t\t\t\thtml = html.substring( index + 3 );\n\t\t\t\t\t\tchars = false;\n\t\t\t\t\t}\n\t\n\t\t\t\t// end tag\n\t\t\t\t} else if ( html.indexOf(\"</\") == 0 ) {\n\t\t\t\t\tmatch = html.match( endTag );\n\t\n\t\t\t\t\tif ( match ) {\n\t\t\t\t\t\thtml = html.substring( match[0].length );\n\t\t\t\t\t\tmatch[0].replace( endTag, parseEndTag );\n\t\t\t\t\t\tchars = false;\n\t\t\t\t\t}\n\t\n\t\t\t\t// start tag\n\t\t\t\t} else if ( html.indexOf(\"<\") == 0 ) {\n\t\t\t\t\tmatch = html.match( startTag );\n\t\n\t\t\t\t\tif ( match ) {\n\t\t\t\t\t\thtml = html.substring( match[0].length );\n\t\t\t\t\t\tmatch[0].replace( startTag, parseStartTag );\n\t\t\t\t\t\tchars = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( chars ) {\n\t\t\t\t\tindex = html.indexOf(\"<\");\n\t\t\t\t\t\n\t\t\t\t\tvar text = index < 0 ? html : html.substring( 0, index );\n\t\t\t\t\thtml = index < 0 ? \"\" : html.substring( index );\n\t\t\t\t\t\n\t\t\t\t\tif ( handler.chars )\n\t\t\t\t\t\thandler.chars( text );\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\thtml = html.replace(new RegExp(\"(.*)<\\/\" + stack.last() + \"[^>]*>\"), function(all, text){\n\t\t\t\t\ttext = text.replace(/<!--(.*?)-->/g, \"$1\")\n\t\t\t\t\t\t.replace(/<!\\[CDATA\\[(.*?)]]>/g, \"$1\");\n\n\t\t\t\t\tif ( handler.chars )\n\t\t\t\t\t\thandler.chars( text );\n\n\t\t\t\t\treturn \"\";\n\t\t\t\t});\n\n\t\t\t\tparseEndTag( \"\", stack.last() );\n\t\t\t}\n\n\t\t\tif ( html == last )\n\t\t\t\tthrow \"Parse Error: \" + html;\n\t\t\tlast = html;\n\t\t}\n\t\t\n\t\t// Clean up any remaining tags\n\t\tparseEndTag();\n\n\t\tfunction parseStartTag( tag, tagName, rest, unary ) {\n\t\t\ttagName = tagName.toLowerCase();\n\n\t\t\tif ( block[ tagName ] ) {\n\t\t\t\twhile ( stack.last() && inline[ stack.last() ] ) {\n\t\t\t\t\tparseEndTag( \"\", stack.last() );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( closeSelf[ tagName ] && stack.last() == tagName ) {\n\t\t\t\tparseEndTag( \"\", tagName );\n\t\t\t}\n\n\t\t\tunary = empty[ tagName ] || !!unary;\n\n\t\t\tif ( !unary )\n\t\t\t\tstack.push( tagName );\n\t\t\t\n\t\t\tif ( handler.start ) {\n\t\t\t\tvar attrs = [];\n\t\n\t\t\t\trest.replace(attr, function(match, name) {\n\t\t\t\t\tvar value = arguments[2] ? arguments[2] :\n\t\t\t\t\t\targuments[3] ? arguments[3] :\n\t\t\t\t\t\targuments[4] ? arguments[4] :\n\t\t\t\t\t\tfillAttrs[name] ? name : \"\";\n\t\t\t\t\t\n\t\t\t\t\tattrs.push({\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\tescaped: value.replace(/(^|[^\\\\])\"/g, '$1\\\\\\\"') //\"\n\t\t\t\t\t});\n\t\t\t\t});\n\t\n\t\t\t\tif ( handler.start )\n\t\t\t\t\thandler.start( tagName, attrs, unary );\n\t\t\t}\n\t\t}\n\n\t\tfunction parseEndTag( tag, tagName ) {\n\t\t\t// If no tag name is provided, clean shop\n\t\t\tif ( !tagName )\n\t\t\t\tvar pos = 0;\n\t\t\t\t\n\t\t\t// Find the closest opened tag of the same type\n\t\t\telse\n\t\t\t\tfor ( var pos = stack.length - 1; pos >= 0; pos-- )\n\t\t\t\t\tif ( stack[ pos ] == tagName )\n\t\t\t\t\t\tbreak;\n\t\t\t\n\t\t\tif ( pos >= 0 ) {\n\t\t\t\t// Close all the open elements, up the stack\n\t\t\t\tfor ( var i = stack.length - 1; i >= pos; i-- )\n\t\t\t\t\tif ( handler.end )\n\t\t\t\t\t\thandler.end( stack[ i ] );\n\t\t\t\t\n\t\t\t\t// Remove the open elements from the stack\n\t\t\t\tstack.length = pos;\n\t\t\t}\n\t\t}\n\t};\n\t\n\tthis.HTMLtoXML = function( html ) {\n\t\tvar results = \"\";\n\t\t\n\t\tHTMLParser(html, {\n\t\t\tstart: function( tag, attrs, unary ) {\n\t\t\t\tresults += \"<\" + tag;\n\t\t\n\t\t\t\tfor ( var i = 0; i < attrs.length; i++ )\n\t\t\t\t\tresults += \" \" + attrs[i].name + '=\"' + attrs[i].escaped + '\"';\n\t\t\n\t\t\t\tresults += (unary ? \"/\" : \"\") + \">\";\n\t\t\t},\n\t\t\tend: function( tag ) {\n\t\t\t\tresults += \"</\" + tag + \">\";\n\t\t\t},\n\t\t\tchars: function( text ) {\n\t\t\t\tresults += text;\n\t\t\t},\n\t\t\tcomment: function( text ) {\n\t\t\t\tresults += \"<!--\" + text + \"-->\";\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn results;\n\t};\n\t\n\tthis.HTMLtoDOM = function( html, doc ) {\n\t\t// There can be only one of these elements\n\t\tvar one = makeMap(\"html,head,body,title\");\n\t\t\n\t\t// Enforce a structure for the document\n\t\tvar structure = {\n\t\t\tlink: \"head\",\n\t\t\tbase: \"head\"\n\t\t};\n\t\n\t\tif ( !doc ) {\n\t\t\tif ( typeof DOMDocument != \"undefined\" )\n\t\t\t\tdoc = new DOMDocument();\n\t\t\telse if ( typeof document != \"undefined\" && document.implementation && document.implementation.createDocument )\n\t\t\t\tdoc = document.implementation.createDocument(\"\", \"\", null);\n\t\t\telse if ( typeof ActiveX != \"undefined\" )\n\t\t\t\tdoc = new ActiveXObject(\"Msxml.DOMDocument\");\n\t\t\t\n\t\t} else\n\t\t\tdoc = doc.ownerDocument ||\n\t\t\t\tdoc.getOwnerDocument && doc.getOwnerDocument() ||\n\t\t\t\tdoc;\n\t\t\n\t\tvar elems = [],\n\t\t\tdocumentElement = doc.documentElement ||\n\t\t\t\tdoc.getDocumentElement && doc.getDocumentElement();\n\t\t\t\t\n\t\t// If we're dealing with an empty document then we\n\t\t// need to pre-populate it with the HTML document structure\n\t\tif ( !documentElement && doc.createElement ) (function(){\n\t\t\tvar html = doc.createElement(\"html\");\n\t\t\tvar head = doc.createElement(\"head\");\n\t\t\thead.appendChild( doc.createElement(\"title\") );\n\t\t\thtml.appendChild( head );\n\t\t\thtml.appendChild( doc.createElement(\"body\") );\n\t\t\tdoc.appendChild( html );\n\t\t})();\n\t\t\n\t\t// Find all the unique elements\n\t\tif ( doc.getElementsByTagName )\n\t\t\tfor ( var i in one )\n\t\t\t\tone[ i ] = doc.getElementsByTagName( i )[0];\n\t\t\n\t\t// If we're working with a document, inject contents into\n\t\t// the body element\n\t\tvar curParentNode = one.body;\n\t\t\n\t\tHTMLParser( html, {\n\t\t\tstart: function( tagName, attrs, unary ) {\n\t\t\t\t// If it's a pre-built element, then we can ignore\n\t\t\t\t// its construction\n\t\t\t\tif ( one[ tagName ] ) {\n\t\t\t\t\tcurParentNode = one[ tagName ];\n\t\t\t\t\tif ( !unary ) {\n\t\t\t\t\t\telems.push( curParentNode );\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\n\t\t\t\tvar elem = doc.createElement( tagName );\n\t\t\t\t\n\t\t\t\tfor ( var attr in attrs )\n\t\t\t\t\telem.setAttribute( attrs[ attr ].name, attrs[ attr ].value );\n\t\t\t\t\n\t\t\t\tif ( structure[ tagName ] && typeof one[ structure[ tagName ] ] != \"boolean\" )\n\t\t\t\t\tone[ structure[ tagName ] ].appendChild( elem );\n\t\t\t\t\n\t\t\t\telse if ( curParentNode && curParentNode.appendChild )\n\t\t\t\t\tcurParentNode.appendChild( elem );\n\t\t\t\t\t\n\t\t\t\tif ( !unary ) {\n\t\t\t\t\telems.push( elem );\n\t\t\t\t\tcurParentNode = elem;\n\t\t\t\t}\n\t\t\t},\n\t\t\tend: function( tag ) {\n\t\t\t\telems.length -= 1;\n\t\t\t\t\n\t\t\t\t// Init the new parentNode\n\t\t\t\tcurParentNode = elems[ elems.length - 1 ];\n\t\t\t},\n\t\t\tchars: function( text ) {\n\t\t\t\tcurParentNode.appendChild( doc.createTextNode( text ) );\n\t\t\t},\n\t\t\tcomment: function( text ) {\n\t\t\t\t// create comment node\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn doc;\n\t};\n\n\tfunction makeMap(str){\n\t\tvar obj = {}, items = str.split(\",\");\n\t\tfor ( var i = 0; i < items.length; i++ )\n\t\t\tobj[ items[i] ] = true;\n\t\treturn obj;\n\t}\n})();"]}